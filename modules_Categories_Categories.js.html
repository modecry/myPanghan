<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>modules/Categories/Categories.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BlockContent.html">BlockContent</a></li><li><a href="Categories.html">Categories</a><ul class='methods'><li data-type='method'><a href="Categories.html#toggle">toggle</a></li></ul></li><li><a href="SearchPanel.html">SearchPanel</a></li><li><a href="StructuredContent.html">StructuredContent</a></li></ul><h3>Modules</h3><ul><li><a href="module-Services.html">Services</a><ul class='methods'><li data-type='method'><a href="module-Services.html#.changeQuries">changeQuries</a></li><li data-type='method'><a href="module-Services.html#.constructData">constructData</a></li><li data-type='method'><a href="module-Services.html#.dataFormater">dataFormater</a></li><li data-type='method'><a href="module-Services.html#.deleteQuery">deleteQuery</a></li><li data-type='method'><a href="module-Services.html#.getData">getData</a></li><li data-type='method'><a href="module-Services.html#.renderTemplate">renderTemplate</a></li><li data-type='method'><a href="module-Services.html#.saveQuery">saveQuery</a></li></ul></li><li><a href="module-Utils.html">Utils</a><ul class='methods'><li data-type='method'><a href="module-Utils.html#.filterData">filterData</a></li><li data-type='method'><a href="module-Utils.html#.toggleActive">toggleActive</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">modules/Categories/Categories.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {toggleActive} from "utils";
/**
 *  @class Categories
 *  @param {HTMLElement} root - нода для рендеринга
 *  @param parentParams {Object} - параметры прокидываемые от родителя
 *  @param parentParams.state {Object} - данные которые хранятся в родителе
 *  @param parentParams.methods {Array} - методы для работы с
 *  @classdesc Класс для формирования категорий
 */
class Categories {
    constructor(root, {methods, state}) {
        this.categoriesList = state.categories;  // массив категорий
        this.nodeListCategories = null;  // лист node  объектов
        this.root = root; // корневой root элемент
        this.parentMethods = methods; // родительские методы
        this.parentState = state; // родительский стейт
    }

    /**
     *  Замыкающий метод для обработки нажатия по категории
     * @param category - node экземпляр для навешивания
     * @returns {Function}
     */
    toggle(category) {
        const {
            viewCategories: nodeList, // node list  категорий
            parentMethods: {setFilters} // метод установки фильтров
        } = this;

        const attributeName = "name"; // требуемый атрибут для установки класса active
        const currentAttr = category.getAttribute(attributeName); // атрибут конкретной ноды

        /**
         * Коллбэк пробрасываемый в метод toggle
         */
        const callbackCategories = () => {
            if (category.classList.value.includes("active")) {
                setFilters(); // отчитска фильтра по категорям
            } else {
                setFilters(currentAttr,""); // установка фильтра по категорям
            }
        }

        return toggleActive({
            nodeList: this.nodeListCategories,
            currentAttr,
            attributeName
        }, "active", callbackCategories);
    }

    /**
     *  сброс класса active
     */
    clearCategories = ()=>{
        const {nodeListCategories} = this;
        for (let i = 0; i&lt;nodeListCategories.length; i++){
            nodeListCategories[i].classList.remove("active");
        }
    }

    /**
     * Рендер ноды категории
     * @param text - описание
     * @param attr - [name] атрибут ноды
     * @returns {string} - Строка с нодой
     */
    renderCategory = ({name: text, id}) => {
        if(text==="default") return; // убираем дефолтную категорию
        const active = this.parentState.filters.category  === text? "active":"";
        return `&lt;div class="catbtn ${active} category-${id}" name="${text}">${text}&lt;/div>`;
    };

    /**
     *  Рендер категорий
     */
    renderCategories = () => {
        const {root, renderCategory} = this;
        const categories = this.categoriesList.map(category => renderCategory(category)); // мапим категории
        /*Рендеринг*/
        const container = document.createElement("div");
        container.classList = "t-col t-col_10 t-prefix_1 t-text";
        container.innerHTML  = `        
                &lt;div id="mycategories" class="inner_content">
                    ${categories.join("")}
                &lt;/div>`;
        root.appendChild(container);

        /*Установка обработчиков*/
        this.nodeListCategories = document.querySelectorAll(".catbtn"); // определяем  лист node
        this.nodeListCategories.forEach(category =>
            category.addEventListener("click", this.toggle(category))
        ); // навешиваем обработчик на каждую ноду
    }

    /**
     * Иницилизация категорий
     */
    init = () => {
        this.renderCategories();
    };
}

export default Categories;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Fri Feb 07 2020 16:09:03 GMT+0300 (MSK) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
